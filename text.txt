local Phi = {layer = 2,debug = false}


local bump = require("libs/bump")

 Phi.world = bump.newWorld()
 Phi.objs = {}
 Phi.idblacklist = {420}

  function Phi.add(obj)
    Phi.world:add(obj,obj.x,obj.y,obj.w,obj.h)
    table.insert(Phi.objs,obj)
  end

  function Phi.kill(obj)
    for i = 1,#Phi.objs do
      if Phi.objs[i] == obj then
        table.remove(Phi.objs,i)
        Phi.world:remove(obj)
      end
    end
  end

  function Phi.move(obj,targetX,targetY)
    nextX,nextY,cols,len = Phi.world:move(obj,targetX,targetY,set)
    if len > 0 then
      for i,col in ipairs(cols) do
        if col.normal.x ~= 0 then
          obj.vel.x = 0
        end
        if col.normal.y ~= 0 then
          obj.vel.y = 0
        end
      end
    end
    if set == true then
    obj.x,obj.y = nextX,nextY
    end
    return cols
  end

  function Phi.toggle_debug()
   Phi.debug = not Phi.debug or false
   end


	function Phi.draw()
	  camera.set()
	  for i,obj in ipairs(Phi.objs) do
	    love.graphics.rectangle("fill",obj.x,obj.y,obj.w or 32, obj.h or 32) -- change the "32" to your tile size
	  end
	    camera.unset()
	 end
renderer.renderMe(Phi)
return Phi
